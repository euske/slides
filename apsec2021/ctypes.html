<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>How Do Programmers Express High-Level Concepts using Primitive Data Types? -
Yusuke Shinyama, Yoshitaka Arahori and Katsuhiko Gondow (APSEC 2021 Paper #125)
</title>
<style><!--
body { line-height: 1.5; }
h1 { border-bottom: solid 4px #000080; }
h2 { border-bottom: solid 2px #000080; }
h3 { border-bottom: solid 1px #000080; }
table { border-collapse: collapse; margin: 0.5em; }
kbd { border: 1px solid black; padding: 4px; margin: 4px; }
code { font-weight: bold; }
pre { border: 1px solid black; padding: 0.3em; }
.announce { font-size: 120%; font-weight: bold; }
.author { text-align: right; }
.figure { outline: 1px solid black; padding: 0.5em; margin: 1em; text-align: center; }
.notice { text-align: center; font-weight: bold; outline: 4px solid black; padding: 1em; margin: 1em; font-size: 200%; }
.comment { color: green; }
.path { background: #cfc; }
.xcoord { background: #cff; }
.ycoord { background: #ccf; }
.width { background: #fcc; }
.height { background: #ffc; }
--></style>
</head>
<body>
<div class=nav>
<a href="../index.html">&lt; back</a>
</div>
<h1>How Do Programmers Express High-Level Concepts using Primitive Data Types?</h1>
<div class=announce>
URL: <code>https://euske.github.io/</code>
</div>

<div class=author>
Yusuke Shinyama<br>
Yoshitaka Arahori<br>
Katsuhiko Gondow<br>
(APSEC 2021 Paper #125)<br>
</div>

<ol>
<li> <a href="#background">Background</a>
<ul>
<li> <a href="#rqs">Research Questions</a>
<li> <a href="#related">Related Work</a>
</ul>
<li> <a href="#basic">Basic Idea</a>
<li> <a href="#experiment">Experiment</a>
<li> <a href="#inference">Inferring C-types</a>
<li> <a href="#conclusion">Conclusion</a>
<ul>
<li> <a href="#threats">Threats to Validity</a>
</ul>
</ol>


<h2 id="background">1. Background</h2>
<ul>
<li> Modern programming languages allow various user defined types.
<li> <strong>Primitive obsession</strong> often is considered as bad smell:
<blockquote><pre>
String username = getCurrentUserName();
String path = "/home/"+username+"/user.cfg";
<span class=comment>// Unsafe path: extra check is needed!</span>
File config = new File(path);
</pre></blockquote>
<p>
A better (but cumbersome) code would be:
<blockquote><pre>
User user = getCurrentUser();
Path path = Paths.get(user.getHomeDirectory(), "user.cfg");
<span class=comment>// Path is guaranteed to be safe.</span>
File config = new File(path);
</pre></blockquote>
<li> <code>String</code> and <code>int</code> types, however,
  are still used for a wide variety of purposes.
<li> We are interested in how generic data types
  (such as <code>String</code> and <code>int</code>)
  are used in various software projects.
</ul>


<h3 id="rqs">1.1. Research Questions</h3>
<ol>
<li> What are common "high-level data types"?
<li> How do programmers express these high-level types in source code?
<li> Is it possible to infer them from surface clues?
</ol>

<h3 id="related">1.2. Related Work</h3>
<ul>
<li> O'Callahan et al.: Type identification by static analysis + type inference.
When two values are stored at the same location, they are the same type.
<li> Guo et al.:  Dynamic analysis + type inference.
<li> Dash et al.: Similar names imply related types.
<li> Jiang et al.: Type inconsistency detection via dimensional analysis.
</ul>

<h2 id="basic">2. Basic Idea</h2>
<p>
When programmers make an API call, they are aware of the role of its arguments:
<blockquote><pre>
String <mark>x</mark> = "foo/bar.txt";
var f = new java.io.File(<mark>x</mark>);  <span class=comment>// x is a pathname</span>
</pre></blockquote>

<ul>
<li> While <code><mark>x</mark></code> is <code>String</code>,
we know that it's a pathname because of how it's used.
<li> We define these specific roles of data types
as <strong>Conceptual Types</strong> or <strong>c-type</strong>.
<div>
<svg xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     version="1.1" width="200" height="150">
  <g stroke="black" stroke-width="2" fill="none">
    <circle cx="100" cy="75" r="70" />
    <circle cx="120" cy="90" r="40" />
  </g>
  <g text-anchor="middle">
    <text x="100" y="40">data type</text>
    <text x="120" y="100">c-type</text>
  </g>
</svg>
</div>
<li> API calls are easy to collect and its function is well defined.<br>
  &rarr; <strong>They provide us a plenty of unambiguous use cases of c-types!</strong>
</ul>

<p>
We defined 12 commonly used c-types:
<table border>
<tr><th>C-Type</th></th><th>Language Type</th><th>Description</th><th># Methods</th></tr>
<tr><td>PATH   </td><td> <code>String</code> </td><td> Path name</td>
<td align=right>14</td></tr>
<tr><td>URL    </td><td> <code>String</code> </td><td> URL/URI</td>
<td align=right>4</td></tr>
<tr><td>SQL    </td><td> <code>String</code> </td><td> SQL statement</td>
<td align=right>10</td></tr>
<tr><td>HOST   </td><td> <code>String</code> </td><td> Host name</td>
<td align=right>17</td></tr>
<tr><td>PORT   </td><td> <code>int</code>    </td><td> Port number</td>
<td align=right>25</td></tr>
<tr><td>XCOORD </td><td> <code>int</code>    </td><td> X coordinate (GUI)</td>
<td align=right>25</td></tr>
<tr><td>YCOORD </td><td> <code>int</code>    </td><td> Y coordinate (GUI)</td>
<td align=right>25</td></tr>
<tr><td>WIDTH  </td><td> <code>int</code>    </td><td> width (GUI)</td>
<td align=right>24</td></tr>
<tr><td>HEIGHT </td><td> <code>int</code>    </td><td> height (GUI)</td>
<td align=right>24</td></tr>
<tr><td>YEAR   </td><td> <code>int</code>    </td><td> year</td>
<td align=right>18</td></tr>
<tr><td>MONTH  </td><td> <code>int</code>    </td><td> month</td>
<td align=right>14</td></tr>
<tr><td>DAY    </td><td> <code>int</code>    </td><td> day</td>
<td align=right>18</td></tr>
</table>

<p>
The criterion that we used are:
<ol type=a>
<li> Clearly defined and well understood.
<li> Distinct enough to not mix up with other concepts.
<li> Widely used in many applications.
</ol>

<p>
We studied Java Standard API and
listed 218 methods that takes a c-type:
<ul>
<li> <code>new java.io.File(<u>PATH</u>)</code>
<li> <code>new java.net.URI(<u>URL</u>)</code>
<li> <code>java.sql.Statement.execute(<u>SQL</u>)</code>
<li> <code>java.net.InetAddress.getByName(<u>HOST</u>)</code>
<li> <code>new java.net.Socket(<u>HOST</u>, <u>PORT</u>)</code>
<li> <code>new java.awt.Point(<u>XCOORD</u>, <u>YCOORD</u>)</code>
<li> <code>new java.awt.Dimension(<u>WIDTH</u>, <u>HEIGHT</u>)</code>
<li> <code>new java.util.Date(<u>YEAR</u>, <u>MONTH</u>, <u>DAY</u>)</code>
<li> <code>java.util.Date.setYear(<u>YEAR</u>)</code>
<li> <code>java.time.LocalDate.of(<u>YEAR</u>, <u>MONTH</u>, <u>DAY</u>)</code>
<li> ...
</ul>

<h2 id="experiment">3. Experiment</h2>

<p>
We did the following experiments:
<ol>
<li> Choose medium-sized 26 Java open source projects.
<li> Search all the specified API calls.
<li> Extract <strong>c-type expressions</strong> from the arguments of each API call.
<li> Examine the type, complexity and commonly used words for each c-type expression.
</ol>

<h4>C-type Expression Examples:</h4>
<blockquote><pre>
<u>zookeeper/.../TxnLogToolkit.java:</u>
    ...
    File file = new File(<span class=path>dir.getPath() + File.separator + Util.makeLogName(zxid)</span><sub>[PATH]</sub>);
</pre></blockquote>

<blockquote><pre>
<u>jitsi/.../SIPCommSplitPaneDivider.java:</u>
    ...
    rightButton.setBounds(<span class=xcoord>(insets.left * 2) + leftSize.width + rightSize.width</span><sub>[XCOORD]</sub>,
                          <span class=ycoord>y</span><sub>[YCOORD]</sub>, <span class=width>rightSize.width</span><sub>[WIDTH]</sub>, <span class=height>rightSize.height</span><sub>[HEIGHT]</sub>);
</pre></blockquote>

<h3 id="projects">3.1. Projects and Sizes</h3>
<table border>
<tr><th>Project</th><th>Description</th><th>LoC</th></tr>
<tr><td>hadoop 3.3.1      </td><td>distributed computation </td><td align=right>1,789k</td></tr>
<tr><td>ghidra 10.0       </td><td>binary analyzer         </td><td align=right>1,588k</td></tr>
<tr><td>ignite 2.10.0     </td><td>distributed database    </td><td align=right>1,165k</td></tr>
<tr><td>jetty 11.0.5      </td><td>web container           </td><td align=right>  441k</td></tr>
<tr><td>kafka 2.7.1       </td><td>stream processing       </td><td align=right>  384k</td></tr>
<tr><td>tomcat 8.5.68     </td><td>web server              </td><td align=right>  349k</td></tr>
<tr><td>jitsi 2.10        </td><td>video conference        </td><td align=right>  327k</td></tr>
<tr><td>binnavi 6.1.0     </td><td>binary analyzer         </td><td align=right>  309k</td></tr>
<tr><td>netty 4.1.65      </td><td>network library         </td><td align=right>  303k</td></tr>
<tr><td>libgdx 1.10.0     </td><td>game framework          </td><td align=right>  272k</td></tr>
<tr><td>alluxio 2.5.0-3   </td><td>data orchestration      </td><td align=right>  228k</td></tr>
<tr><td>plantuml 1.2021.7 </td><td>UML generator           </td><td align=right>  210k</td></tr>
<tr><td>grpc 1.38.1       </td><td>RPC framework           </td><td align=right>  195k</td></tr>
<tr><td>jenkins 2.299     </td><td>automation              </td><td align=right>  177k</td></tr>
<tr><td>jmeter 5.4.1      </td><td>network analyzer        </td><td align=right>  145k</td></tr>
<tr><td>jedit 5.6.0       </td><td>text editor             </td><td align=right>  125k</td></tr>
<tr><td>gephi 0.9.2       </td><td>graph visualizer        </td><td align=right>  120k</td></tr>
<tr><td>zookeeper 3.7.0   </td><td>distributed computation </td><td align=right>  114k</td></tr>
<tr><td>selenium 3.141.59 </td><td>browser automation      </td><td align=right>   91k</td></tr>
<tr><td>okhttp 4.9.1      </td><td>HTTP client             </td><td align=right>   36k</td></tr>
<tr><td>jhotdraw 7.0.6    </td><td>graph drawing           </td><td align=right>   32k</td></tr>
<tr><td>arduino 1.8.15    </td><td>development environment </td><td align=right>   27k</td></tr>
<tr><td>gson 2.8.7        </td><td>serialization framework </td><td align=right>   25k</td></tr>
<tr><td>websocket 1.5.2   </td><td>network framework       </td><td align=right>   15k</td></tr>
<tr><td>picasso 2.8       </td><td>image processing        </td><td align=right>    9k</td></tr>
<tr><td>jpacman           </td><td>action game             </td><td align=right>    3k</td></tr>
<tr><td colspan="2">Total</td><td>8,480k</td></tr>
</table>

<h3 id="numctypes">3.2. Number of Obtained C-Type Expressions</h3>
<p>
The distribution of c-type expressions differs by application domain.
The total number of c-types is roughly propotional to the project size.
<table border>
<tr><th>Project</th><th>LoC</th><th><code>PATH</code></th><th><code>URL</code></th><th><code>SQL</code></th><th><code>HOST</code></th><th><code>PORT</code></th><th><code>XCOORD</code></th><th><code>YCOORD</code></th><th><code>WIDTH</code></th><th><code>HEIGHT</code></th><th><code>YEAR</code></th><th><code>MONTH</code></th><th><code>DAY</code></th><th><code>OTHER</code></th><th>All</th></tr>
<tr><td>   alluxio </td><td align=right>  228k </td><td align=right>  72 </td><td align=right>  12 </td><td align=right>   0 </td><td align=right>  22 </td><td align=right>  26 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>  15 </td><td align=right>  15 </td><td align=right>  15 </td><td align=right>  51 </td><td align=right>  228 </td></tr>
<tr><td>   arduino </td><td align=right>   27k </td><td align=right>  39 </td><td align=right>   5 </td><td align=right>   0 </td><td align=right>  12 </td><td align=right>   9 </td><td align=right>   6 </td><td align=right>   6 </td><td align=right>  42 </td><td align=right>  42 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   1 </td><td align=right>  162 </td></tr>
<tr><td>   binnavi </td><td align=right>  309k </td><td align=right>  42 </td><td align=right>   7 </td><td align=right>   1 </td><td align=right>   2 </td><td align=right>   1 </td><td align=right>  23 </td><td align=right>  23 </td><td align=right>  67 </td><td align=right>  67 </td><td align=right>   1 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   1 </td><td align=right>  235 </td></tr>
<tr><td>     gephi </td><td align=right>  120k </td><td align=right>   5 </td><td align=right>   0 </td><td align=right>   2 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>  28 </td><td align=right>  28 </td><td align=right>  66 </td><td align=right>  66 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>  195 </td></tr>
<tr><td>    ghidra </td><td align=right>1,588k </td><td align=right> 369 </td><td align=right>  25 </td><td align=right>   0 </td><td align=right>  10 </td><td align=right>   8 </td><td align=right> 320 </td><td align=right> 320 </td><td align=right> 511 </td><td align=right> 511 </td><td align=right>  13 </td><td align=right>  13 </td><td align=right>  13 </td><td align=right>  13 </td><td align=right> 2,126</td></tr>
<tr><td>      grpc </td><td align=right>  195k </td><td align=right>  33 </td><td align=right>  16 </td><td align=right>   0 </td><td align=right>  68 </td><td align=right>  71 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>  75 </td><td align=right>  263 </td></tr>
<tr><td>      gson </td><td align=right>   25k </td><td align=right>   0 </td><td align=right>   4 </td><td align=right>   0 </td><td align=right>   2 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   6 </td><td align=right>   6 </td><td align=right>   6 </td><td align=right>   7 </td><td align=right>   31 </td></tr>
<tr><td>    hadoop </td><td align=right>1,789k </td><td align=right> 978 </td><td align=right> 634 </td><td align=right>   9 </td><td align=right> 288 </td><td align=right> 259 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   2 </td><td align=right>   2 </td><td align=right>   2 </td><td align=right> 124 </td><td align=right> 2,298</td></tr>
<tr><td>    ignite </td><td align=right>1,165k </td><td align=right> 168 </td><td align=right>  85 </td><td align=right> 666 </td><td align=right> 106 </td><td align=right> 111 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>  12 </td><td align=right>  12 </td><td align=right>  12 </td><td align=right> 101 </td><td align=right> 1,273</td></tr>
<tr><td>     jedit </td><td align=right>  125k </td><td align=right> 130 </td><td align=right>  19 </td><td align=right>   0 </td><td align=right>   3 </td><td align=right>   3 </td><td align=right>  50 </td><td align=right>  50 </td><td align=right> 112 </td><td align=right> 112 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   3 </td><td align=right>  482 </td></tr>
<tr><td>   jenkins </td><td align=right>  117k </td><td align=right>  82 </td><td align=right>  28 </td><td align=right>   0 </td><td align=right>   6 </td><td align=right>   6 </td><td align=right>   1 </td><td align=right>   1 </td><td align=right>   1 </td><td align=right>   1 </td><td align=right> 102 </td><td align=right> 102 </td><td align=right> 102 </td><td align=right> 237 </td><td align=right>  669 </td></tr>
<tr><td>     jetty </td><td align=right>  441k </td><td align=right>  72 </td><td align=right> 216 </td><td align=right>   9 </td><td align=right> 163 </td><td align=right> 104 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>  37 </td><td align=right>  601 </td></tr>
<tr><td>  jhotdraw </td><td align=right>   32k </td><td align=right>   6 </td><td align=right>   5 </td><td align=right>   0 </td><td align=right>   1 </td><td align=right>   1 </td><td align=right>  96 </td><td align=right>  96 </td><td align=right>  50 </td><td align=right>  50 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   1 </td><td align=right>  306 </td></tr>
<tr><td>     jitsi </td><td align=right>  327k </td><td align=right>  22 </td><td align=right>  18 </td><td align=right>   1 </td><td align=right>   8 </td><td align=right>  31 </td><td align=right>  78 </td><td align=right>  78 </td><td align=right> 234 </td><td align=right> 234 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>  30 </td><td align=right>  734 </td></tr>
<tr><td>    jmeter </td><td align=right>  145k </td><td align=right> 112 </td><td align=right>  62 </td><td align=right>   2 </td><td align=right>  31 </td><td align=right>  28 </td><td align=right>   7 </td><td align=right>   7 </td><td align=right>  62 </td><td align=right>  62 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>  28 </td><td align=right>  401 </td></tr>
<tr><td>   jpacman </td><td align=right>    3k </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   1 </td><td align=right>   1 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>    2 </td></tr>
<tr><td>     kafka </td><td align=right>  384k </td><td align=right>  37 </td><td align=right>   1 </td><td align=right>   0 </td><td align=right>  85 </td><td align=right>  72 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>  14 </td><td align=right>  14 </td><td align=right>  14 </td><td align=right>  44 </td><td align=right>  281 </td></tr>
<tr><td>    libgdx </td><td align=right>  272k </td><td align=right>  83 </td><td align=right>   7 </td><td align=right>   0 </td><td align=right>   4 </td><td align=right>   5 </td><td align=right>   7 </td><td align=right>   7 </td><td align=right>  36 </td><td align=right>  36 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>  185 </td></tr>
<tr><td>     netty </td><td align=right>  303k </td><td align=right>  38 </td><td align=right>  24 </td><td align=right>   0 </td><td align=right>  54 </td><td align=right> 130 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   1 </td><td align=right>   1 </td><td align=right>   1 </td><td align=right> 117 </td><td align=right>  366 </td></tr>
<tr><td>    okhttp </td><td align=right>   36k </td><td align=right>   2 </td><td align=right>  24 </td><td align=right>   0 </td><td align=right>   6 </td><td align=right>   7 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   3 </td><td align=right>   42 </td></tr>
<tr><td>   picasso </td><td align=right>    9k </td><td align=right>   1 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>    1 </td></tr>
<tr><td>  plantuml </td><td align=right>  210k </td><td align=right>  29 </td><td align=right>   4 </td><td align=right>   0 </td><td align=right>   5 </td><td align=right>  11 </td><td align=right>   4 </td><td align=right>   4 </td><td align=right>  11 </td><td align=right>  11 </td><td align=right>   2 </td><td align=right>   2 </td><td align=right>   2 </td><td align=right>   2 </td><td align=right>   87 </td></tr>
<tr><td>  selenium </td><td align=right>   91k </td><td align=right>  44 </td><td align=right>  66 </td><td align=right>   0 </td><td align=right>  15 </td><td align=right>  12 </td><td align=right>   1 </td><td align=right>   1 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   1 </td><td align=right>   1 </td><td align=right>   1 </td><td align=right>  21 </td><td align=right>  163 </td></tr>
<tr><td>    tomcat </td><td align=right>  349k </td><td align=right> 207 </td><td align=right>  64 </td><td align=right>  22 </td><td align=right>  38 </td><td align=right>  52 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>  10 </td><td align=right>  10 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>  47 </td><td align=right>  450 </td></tr>
<tr><td> websocket </td><td align=right>   15k </td><td align=right>   9 </td><td align=right>  44 </td><td align=right>   0 </td><td align=right>   5 </td><td align=right>  43 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   1 </td><td align=right>   1 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   1 </td><td align=right>  104 </td></tr>
<tr><td> zookeeper </td><td align=right>  114k </td><td align=right>  88 </td><td align=right>   4 </td><td align=right>   0 </td><td align=right> 126 </td><td align=right> 192 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   1 </td><td align=right>   1 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>   0 </td><td align=right>  47 </td><td align=right>  459 </td></tr>
<tr><td>Total</td><td align=right>8,480k </td><td align=right> 2,668 </td><td align=right> 1,374 </td><td align=right> 712 </td><td align=right> 1,060 </td><td align=right> 1,182 </td><td align=right> 621 </td><td align=right> 621 </td><td align=right> 1,205 </td><td align=right> 1,205 </td><td align=right> 169 </td><td align=right> 168 </td><td align=right> 168 </td><td align=right> 991 </td><td align=right> 12,144 </td></tr>
</table>

<h3 id="topexprs">3.3. Top C-Type Expressions for Each Project</h3>

<h4>PATH</h4>
<table border>
<tr><th>Project</th><th>Top Expressions</th></tr>
<tr><td>alluxio</td><td><code>path, mLocalUfsPath+ufsBase, base</code></td></tr>
<tr><td>arduino</td><td><code>path, PreferencesData.get("runtime.ide.path")</code></td></tr>
<tr><td>binnavi</td><td><code>filename, directory, pathname</code></td></tr>
<tr><td>gephi</td><td><code>System.getProperty("netbeans.user")</code></td></tr>
<tr><td>ghidra</td><td><code>getTestDirectoryPath(), path, filename</code></td></tr>
<tr><td>grpc</td><td><code>uri.getPath()</code></td></tr>
<tr><td>hadoop</td><td><code>GenericTestUtils.getRandomizedTempPath()</code></td></tr>
<tr><td>ignite</td><td><code>path, U.defaultWorkDirectory(), fileName</code></td></tr>
<tr><td>jedit</td><td><code>path, dir, directory</code></td></tr>
<tr><td>jenkins</td><td><code>System.getProperty("user.home"), war</code></td></tr>
<tr><td>jetty</td><td><code>file.getParent()</code></td></tr>
<tr><td>jhotdraw</td><td><code>prefs.get("projectFile", home)</code></td></tr>
<tr><td>jitsi</td><td><code>path, localPath</code></td></tr>
<tr><td>jmeter</td><td><code>filename, path, file</code></td></tr>
<tr><td>kafka</td><td><code>storeDirectoryPath, argument</code></td></tr>
<tr><td>libgdx</td><td><code>name, sourcePath, imagePath.replace('\textbackslash\textbackslash','/')</code></td></tr>
<tr><td>netty</td><td><code>getClass().getResource("test.crt").getFile()</code></td></tr>
<tr><td>plantuml</td><td><code>filename, newName</code></td></tr>
<tr><td>selenium</td><td><code>System.getProperty("java.io.tmpdir"), logName</code></td></tr>
<tr><td>tomcat</td><td><code>pathname, path, docBase</code></td></tr>
<tr><td>zookeeper</td><td><code>path, KerberosTestUtils.getKeytabFile()</code></td></tr>
</table><table border>

<h4>URL</h4>
<tr><th>Project</th><th>Top Expressions</th></tr>
<tr><td>alluxio</td><td><code>journalDirectory, folder, inputDir</code></td></tr>
<tr><td>arduino</td><td><code>contribution.getUrl(), packageIndexURLString</code></td></tr>
<tr><td>binnavi</td><td><code>url, urlString</code></td></tr>
<tr><td>ghidra</td><td><code>ref, getAbsolutePath(), url.toExternalForm()</code></td></tr>
<tr><td>grpc</td><td><code>target, TARGET, oobTarget</code></td></tr>
<tr><td>gson</td><td><code>nextString, urlValue, uriValue</code></td></tr>
<tr><td>hadoop</td><td><code>uri, url, s</code></td></tr>
<tr><td>ignite</td><td><code>GridTestProperties.getProperty("p2p.uri.cls")</code></td></tr>
<tr><td>jedit</td><td><code>path, str, fileIcon</code></td></tr>
<tr><td>jenkins</td><td><code>url, site.getData().core.url, plugin.url</code></td></tr>
<tr><td>jetty</td><td><code>uri, inputUrl.toString(), s</code></td></tr>
<tr><td>jitsi</td><td><code>url, imagePath, sourceString</code></td></tr>
<tr><td>jmeter</td><td><code>url, LOCAL_HOST, requestPath</code></td></tr>
<tr><td>kafka</td><td><code>config.getString(METRICS_URL_CONFIG)</code></td></tr>
<tr><td>libgdx</td><td><code>url, URI, httpRequest.getUrl()+queryString</code></td></tr>
<tr><td>netty</td><td><code>URL, request.uri(), server</code></td></tr>
<tr><td>selenium</td><td><code>url, baseUrl, (String)raw.get("uri")</code></td></tr>
<tr><td>tomcat</td><td><code>url, location, path</code></td></tr>
<tr><td>websocket</td><td><code>uriField.getText(), uriinput.getText()</code></td></tr>
<tr><td>zookeeper</td><td><code>urlStr</code></td></tr>
</table><table border>
<h4>XCOORD</h4>
<tr><th>Project</th><th>Top Expressions</th></tr>
<tr><td>arduino</td><td><code>noLeft, cancelLeft</code></td></tr>
<tr><td>binnavi</td><td><code>x, m_x</code></td></tr>
<tr><td>gephi</td><td><code>currentMouseX, x, bounds.x</code></td></tr>
<tr><td>ghidra</td><td><code>x, center.x+deltaX, filterPanelBounds.x</code></td></tr>
<tr><td>jedit</td><td><code>x, event.getX(), leftButtonWidth+leftWidth</code></td></tr>
<tr><td>jhotdraw</td><td><code>evt.getX(), x, e.getX()</code></td></tr>
<tr><td>jitsi</td><td><code>x, button.getX(), dx</code></td></tr>
<tr><td>jmeter</td><td><code>graphPanel.getLocation().x, cellRect.x, x</code></td></tr>
<tr><td>libgdx</td><td><code>upButtonX, getWidth()-buttonSize.width-5, x</code></td></tr>
<tr><td>plantuml</td><td><code>e.getX()</code></td></tr>
</table><table border>
<h4>WIDTH</h4>
<tr><th>Project</th><th>Top Expressions</th></tr>
<tr><td>arduino</td><td><code>width, imageW, Preferences.BUTTON_WIDTH</code></td></tr>
<tr><td>binnavi</td><td><code>COLORPANEL_WIDTH, TEXTFIELD_WIDTH, width</code></td></tr>
<tr><td>gephi</td><td><code>w, constraintWidth, DEPTH</code></td></tr>
<tr><td>ghidra</td><td><code>width, center.width, filterPanelBounds.width</code></td></tr>
<tr><td>jedit</td><td><code>width, buttonSize.width, colWidth</code></td></tr>
<tr><td>jhotdraw</td><td><code>frameWidth, r.width, bounds.width</code></td></tr>
<tr><td>jitsi</td><td><code>MAX_MSG_PANE_WIDTH, WIDTH, width</code></td></tr>
<tr><td>jmeter</td><td><code>graphPanel.width</code></td></tr>
<tr><td>libgdx</td><td><code>width, buttonSize.width</code></td></tr>
<tr><td>plantuml</td><td><code>newWidth</code></td></tr>
<tr><td>tomcat</td><td><code>WIDTH</code></td></tr>
</table>

<h3 id="complex">3.4. Complex C-Type Expressions</h3>

<h4>PATH</h4>
<ul>
<li> <code>mLocalUfsPath + ufsBase</code>
<li> <code>selectedFile.getAbsolutePath() + PREFERENCES_FILE_EXTENSION</code>
<li> <code>dir.getPath() + DIR_FAILURE_SUFFIX</code>
<li> <code>U.defaultWorkDirectory() + separatorChar + DEFAULT_TARGET_FOLDER + separatorChar</code>
</ul>
<h4>URL</h4>
<ul>
<li> <code>url.toExternalForm().substring(GhidraURL.PROTOCOL.length() + 1)</code>
<li> <code>str + KMSRESTConstants.SERVICE_VERSION + "/"</code>
<li> <code>newOrigin(getScheme(),getHost(),getPort()).asString() + path</code>
<li> <code>base + configFile</code>
</ul>
<h4>XCOORD</h4>
<ul>
<li> <code>center.x + center.width</code>
<li> <code>leftButtonWidth + leftWidth</code>
<li> <code>evt.getX() - getInsets().left</code>
<li> <code>prefs.getInt(name+".x", 0)</code>
</ul>
<h4>WIDTH</h4>
<ul>
<li> <code>Math.max(contentWidth, menuWidth) + insets.left + insets.right</code>
<li> <code>TITLE_X_OFFSET + titlePreferredSize.width</code>
<li> <code>width + insets.left + insets.right + 2</code>
<li> <code>(int)(bounds.getWidth() * percent)</code>
</ul>

<h3 id="complexity">3.5. Complexity of C-Type Expressions</h3>
<p>
(n: number of terms)
<table border>
<tr><th>C-Type</th><th>n=1</th><th>n=2</th><th>n=3</th><th>n=4</th><th>n=5</th><th>n=6</th><th>n&ge;7</th></tr>
<tr><td><code>PATH  </code></td><td align=right>49.6%</td><td align=right>22.8%</td><td align=right>7.0%</td><td align=right>6.3%</td><td align=right>4.8%</td><td align=right>2.2%</td><td align=right>7.3%</td></tr>
<tr><td><code>URL   </code></td><td align=right>31.6%</td><td align=right>18.5%</td><td align=right>13.7%</td><td align=right>13.5%</td><td align=right>10.2%</td><td align=right>5.8%</td><td align=right>6.8%</td></tr>
<tr><td><code>SQL   </code></td><td align=right>47.5%</td><td align=right>12.1%</td><td align=right>8.7%</td><td align=right>3.1%</td><td align=right>4.4%</td><td align=right>5.5%</td><td align=right>18.8%</td></tr>
<tr><td><code>HOST  </code></td><td align=right>59.2%</td><td align=right>11.5%</td><td align=right>3.0%</td><td align=right>22.1%</td><td align=right>2.0%</td><td align=right>0.1%</td><td align=right>2.1%</td></tr>
<tr><td><code>PORT  </code></td><td align=right>68.4%</td><td align=right>27.5%</td><td align=right>2.1%</td><td align=right>1.2%</td><td align=right>0.3%</td><td align=right>0.4%</td><td align=right>0.0%</td></tr>
<tr><td><code>XCOORD</code></td><td align=right>54.1%</td><td align=right>24.6%</td><td align=right>9.8%</td><td align=right>6.4%</td><td align=right>1.6%</td><td align=right>2.1%</td><td align=right>1.3%</td></tr>
<tr><td><code>YCOORD</code></td><td align=right>52.5%</td><td align=right>22.4%</td><td align=right>10.1%</td><td align=right>9.0%</td><td align=right>2.6%</td><td align=right>1.9%</td><td align=right>1.4%</td></tr>
<tr><td><code>WIDTH </code></td><td align=right>71.0%</td><td align=right>15.2%</td><td align=right>6.3%</td><td align=right>2.5%</td><td align=right>1.5%</td><td align=right>1.8%</td><td align=right>1.7%</td></tr>
<tr><td><code>HEIGHT</code></td><td align=right>71.4%</td><td align=right>15.4%</td><td align=right>6.4%</td><td align=right>3.1%</td><td align=right>1.5%</td><td align=right>1.3%</td><td align=right>1.0%</td></tr>
<tr><td><code>YEAR  </code></td><td align=right>96.4%</td><td align=right>2.4%</td><td align=right>1.2%</td><td align=right>0.0%</td><td align=right>0.0%</td><td align=right>0.0%</td><td align=right>0.0%</td></tr>
<tr><td><code>MONTH </code></td><td align=right>79.8%</td><td align=right>19.6%</td><td align=right>0.6%</td><td align=right>0.0%</td><td align=right>0.0%</td><td align=right>0.0%</td><td align=right>0.0%</td></tr>
<tr><td><code>DAY   </code></td><td align=right>99.4%</td><td align=right>0.0%</td><td align=right>0.6%</td><td align=right>0.0%</td><td align=right>0.0%</td><td align=right>0.0%</td><td align=right>0.0%</td></tr>
</table>

<h2 id="inference">4. Inferring C-types</h2>
<p>
We tried to infer the c-types from the surface clue of expressions.
<p>
Basic strategy:
<ol>
<li> Use the obtained c-type expressions (12k) as training set/test set.
<li> Extract the features from each expression.
<li> Use machine learning (decision tree) to identify the c-type from expressions.
</ol>
<p>
Decision tree-based machine learning is used because
<ul>
<li> They are suitable for symbolic features.
<li> The obtained rules are easy to understand for humans.
</ul>

<h4>Common Top Words for C-Type Expressions:</h4>
<table border>
<tr><th>C-Type</th><th>Top words (# Projects)</th></tr>
<tr><td><code>PATH</code></td><td><code>get</code> (21), <code>path</code> (21), <code>file</code> (20) </td></tr>
<tr><td><code>URL</code></td><td><code>url</code> (19), <code>get</code> (18), <code>string</code> (18) </td></tr>
<tr><td><code>SQL</code></td><td><code>get</code> (6), <code>query</code> (5), <code>create</code> (3) </td></tr>
<tr><td><code>HOST</code></td><td><code>host</code> (21), <code>get</code> (17), <code>address</code> (17) </td></tr>
<tr><td><code>PORT</code></td><td><code>port</code> (22), <code>get</code> (18), <code>local</code> (10) </td></tr>
<tr><td><code>XCOORD</code></td><td><code>width</code> (9), <code>x</code> (9), <code>get</code> (9) </td></tr>
<tr><td><code>YCOORD</code></td><td><code>height</code> (9), <code>y</code> (9), <code>get</code> (8) </td></tr>
<tr><td><code>WIDTH</code></td><td><code>width</code> (13), <code>get</code> (11), <code>size</code> (10) </td></tr>
<tr><td><code>HEIGHT</code></td><td><code>height</code> (12), <code>get</code> (11), <code>size</code> (10) </td></tr>
<tr><td><code>YEAR</code></td><td><code>year</code> (4), <code>get</code> (2), <code>int</code> (2) </td></tr>
<tr><td><code>MONTH</code></td><td><code>january</code> (3), <code>month</code> (3), <code>december</code> (3) </td></tr>
<tr><td><code>DAY</code></td><td><code>day</code> (3), <code>int</code> (2), <code>parse</code> (2) </td></tr>
</table>

<p>
We used a dataflow diagram to extract features from expressions:

<div class=figure>
<svg xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     version="1.1" width="270" height="110">
  <defs>
    <marker id="arrow" viewBox="-5 -5 10 10" markerWidth="8" markerHeight="8" orient="auto">
      <polygon points="-5,-5 5,0 -5,5" fill="black" stroke="none" />
    </marker>
  </defs>
  <g stroke="black" stroke-width="1" fill="none">
    <ellipse cx="160" cy="20" rx="40" ry="15" />
    <ellipse cx="240" cy="20" rx="20" ry="15" />
    <ellipse cx="210" cy="60" rx="40" ry="15" />
    <path d="M210,75 l0,20" marker-end="url(#arrow)" />
    <path d="M170,35 l10,10" marker-end="url(#arrow)" />
    <path d="M240,35 l-5,10" marker-end="url(#arrow)" />
  </g>
  <g text-anchor="middle" style="font-family: monospace;">
    <text x="150" y="100" style="font-size: 125%;">new File(</text>
    <text x="230" y="100" style="font-size: 125%;">)</text>
    <text x="160" y="24">config</text>
    <text x="240" y="24">i</text>
    <text x="210" y="64">getPath()</text>
  </g>
  <g style="font-size: 75%; font-family: helvetica;">
    <text x="0" y="24">Secondary identifiers</text>
    <text x="0" y="64">Primary identifier</text>
  </g>
</svg><br>
Dataflow diagram of "<code>new File(config.getPath(i))</code>"
</div>

<h4>Dependency Rules</h4>
<table border>
<tr><th>Expression</th><th>Dependency</th></tr>
<tr><td><code>#</code> (constant)</td><td>
#</td></tr>
<tr><td><code>A</code> (variable access)</td><td>
A</td></tr>
<tr><td><code>A.B</code> (field access)</td><td>
A &rarr; B</td></tr>
<tr><td><code>B(A)</code> (method call)</td><td>
A &rarr; B()</td></tr>
<tr><td><code>A.B()</code> (instance method call)</td><td>
A &rarr; B()</td></tr>
<tr><td><code>op A</code> (applying a unary operator)</td><td>
A &rarr; op</td></tr>
<tr><td><code>A op B</code> (applying a binary operator)</td><td>
A &rarr; op, B &rarr; op</td></tr>
<tr><td><code>B = A</code> (assignment)</td><td>
A &rarr; B</td></tr>
</table>

<p>
We extract "primary identifier" and "secondary identifier(s)"
from the above diagram:
<ul>
<li> Primary identifer: <code>getPath()</code>
<li> Secondary identifiers: <code>config</code>, <code>i</code>
</ul>

<p>
We tested the obtained decision tree classifier
with leave-one-project-out cross validation:
<ul>
<li> Choose one project (and its c-type expressions) as a test set.
<li> Use the other 25 projects as a training set.
<li> Average the results of all projects.
</ul>

<h4>Classification Performance</h4>

<table border>
<tr><th>C-Type</th><th>Precision</th><th>Recall</th><th>F-score</th></tr>
<tr><td><code>PATH    </code></td><td align=right>  68.9% </td><td align=right> 91.8% </td><td align=right> 78.8% </td></tr>
<tr><td><code>URL     </code></td><td align=right>  61.3% </td><td align=right> 53.0% </td><td align=right> 56.8% </td></tr>
<tr><td><code>SQL     </code></td><td align=right>  70.4% </td><td align=right> 80.6% </td><td align=right> 75.2% </td></tr>
<tr><td><code>HOST    </code></td><td align=right>  70.0% </td><td align=right> 73.8% </td><td align=right> 71.8% </td></tr>
<tr><td><code>PORT    </code></td><td align=right>  84.6% </td><td align=right> 87.5% </td><td align=right> 86.0% </td></tr>
<tr><td><code>XCOORD  </code></td><td align=right>  95.7% </td><td align=right> 82.1% </td><td align=right> 88.3% </td></tr>
<tr><td><code>YCOORD  </code></td><td align=right>  97.5% </td><td align=right> 79.4% </td><td align=right> 87.5% </td></tr>
<tr><td><code>WIDTH   </code></td><td align=right>  92.0% </td><td align=right> 92.5% </td><td align=right> 92.2% </td></tr>
<tr><td><code>HEIGHT  </code></td><td align=right>  90.4% </td><td align=right> 93.4% </td><td align=right> 91.9% </td></tr>
<tr><td><code>YEAR    </code></td><td align=right> 100.0% </td><td align=right> 83.7% </td><td align=right> 91.1% </td></tr>
<tr><td><code>MONTH   </code></td><td align=right> 100.0% </td><td align=right> 77.0% </td><td align=right> 87.0% </td></tr>
<tr><td><code>DAY     </code></td><td align=right> 100.0% </td><td align=right> 61.1% </td><td align=right> 75.9% </td></tr>
<tr><td><strong>Average</strong> </td><td align=right>  <strong>85.9%</strong> </td><td align=right> <strong>79.6%</strong> </td><td align=right> <strong>82.7%</strong> </td></tr>
</table>

<p>
The reason why URL c-type wasn't recognized very well:
URL expressions often include HOST, PORT or PATH
expressions, which confused the classifier:
<blockquote><pre>
"https://"+getHostName()+":"+getPort()+"/"+getPath()
</pre></blockquote>


<h2 id="conclusion">5. Conclusion</h2>
<ul>
<li> We defined 12 c-types used in Java standard API.
<li> C-type expressions can be extracted by scanning API calls.
<li> We studied 26 open source projects.
<li> We used a decision tree classifier to infer the c-type
from its expressions and obtained 83% F-score.
</ul>

<h4>Research Questions (again):</h4>
<ol type=a>
<li> What are common "high-level data types"?<br>
→ The distribution of c-types depends on the domain of each project.
<li> How do programmers express these high-level types in source code?
<li> Is it possible to infer them from surface clues?<br>
→ These questions are related.
By using superficial features, we obtained a classifier with 83% F-score.
This suggests that programmers tend to express the common c-types
in a rather obvious way.
</ol>
<p>
In future, we could use the obtained classifier to
infer c-types in other parts of code.

<h3 id="threats">5.1. Threats to Validity</h3>
<ul>
<li> Not all the Java API are inspected.
<li> Selection bias of open source projects.
<li> Some c-type distinction might be vague: URL and URI, Filename and Pathname, etc.
<li> There could be potentially many other c-types that are rarely used.<Br>
  Our results didn't account them.
</ul>


<hr>
<address>Yusuke Shinyama</address>
